var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function c(a){var c=Object[a];c&&(Object[a]=function(a){b(a);return c(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d["delete"](b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(l){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");
c("seal");var e=0,f=function(a){this.id_=(e+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};f.prototype.set=function(a,c){b(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};f.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};f.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};f.prototype["delete"]=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return f},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(m){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var b=new WeakMap,c=function(a){this.data_={};this.head_=f();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};c.prototype["delete"]=
function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};c.prototype.has=function(a){return!!d(this,a).entry};c.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};c.prototype.entries=function(){return e(this,function(a){return[a.key,
a.value]})};c.prototype.keys=function(){return e(this,function(a){return a.key})};c.prototype.values=function(){return e(this,function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var d=function(a,c){var d;d=c&&typeof c;"object"==d||"function"==d?b.has(c)?d=b.get(c):(d=""+ ++k,b.set(c,d)):d="p_"+c;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(var f=0;f<
e.length;f++){var g=e[f];if(c!==c&&g.key!==g.key||c===g.key)return{id:d,list:e,index:f,entry:g}}return{id:d,list:e,index:-1,entry:void 0}},e=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},f=function(){var a={};return a.previous=a.next=a.head=a},k=0;return c},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(a){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a($jscomp.makeIterator([c]));if(!b.has(c)||1!=b.size||b.add(c)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var e=b.entries(),f=e.next();if(f.done||f.value[0]!=c||f.value[1]!=c)return!1;f=e.next();return f.done||f.value[0]==c||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:e.next().done}catch(k){return!1}}())return a;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=
function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6-impl","es3");scanner={};(function(){for(var a=document.querySelectorAll(".mdl-layout__drawer-button"),b=0;b<a.length;b++)a[b].removeAttribute("tabindex")})();
var x="propesp",logIsEnabled,snapTimeout,toastTimeout,cameraGlobal,actualLiArr,actualScrollEl,actualContentEl,isCameraTabActive=!0,saved_li_arr=[],rejected_li_arr=[],syncArr=[],qrScan={data:[],rejected:[],LOADING:document.querySelector(".loading"),sortNumber:function(a,b){return a-b},initHtmlElement:function(a){return document.getElementById(a)},initVideoObjectOptions:function(a){scanner={};return{video:qrScan.initHtmlElement(a),continuous:!0,mirror:!1,captureImage:!1,backgroundScan:!1,refractoryPeriod:4E3,
scanPeriod:1}},initAvaliableCameras:function(a){Instascan.Camera.getCameras().then(function(b){a()})},initCamera:function(a){scanner.stop();Instascan.Camera.getCameras().then(function(a){if(0<a.length){var b=a[0];$.each(a,function(a,c){if(-1!=c.name.indexOf("back"))return b=c,!1});scanner.start(b);cameraGlobal=b}else alert("Nenhuma camera encontrada.")})},scanStart:function(a){scanner.addListener("scan",function(b){a(b)})},saveScannedData:function(a){console.log("Iniciando verifica\u00e7\u00e3o...");
var b,c,d,e;null!==a.match(/\n/g)||null!==a.match(/\\\"/g)||null!==a.match(/\s/g)?(b=a.replace(/\n/gi,""),b=b.replace(/\\\"/g,'"'),b=b.replace(/\"\: \"/g,'":"').replace(/\", \"/g,'","').replace(/\"\: \{\"/g,'":{"')):b=a;console.log("QR Code content: "+a);console.log("QR Code processed: "+b);null!==b.match(/^\x7b\"\x70\x72\x6f\x70\x65\x73\x70\"\:\x7b(.*)\x7d\x7d/g)?(d=!0,e=!1,a=b):null===b.match(/^\{(.*)\}/g)&&null===b.match(/\s/g)&&(c=d=!0);console.log("isQRValid (pretest): "+(d?"maybe valid":"invalid"));
c&&d&&(console.log("QR Code is maybe encoded. Validating..."),c=CryptoJS.AES.decrypt(b,"propespti2013"),full_dec=c.toString(CryptoJS.enc.Utf8),e=null!==full_dec.match(/^\{(.*)\}/g)?!0:!1);e&&d?(console.log("QR Code is maybe valid!"),console.log("QR Code is encoded!"),console.log("Checking authencity..."),c=CryptoJS.AES.decrypt(b,"propespti2013"),a=c.toString(CryptoJS.enc.Utf8)):!e&&d&&(console.log("QR Code is maybe valid!"),console.log("QR Code is not encoded!"),console.log("Checking authencity..."),
a=b);null!==a.match(/^\x7b\"\x70\x72\x6f\x70\x65\x73\x70\"\:\x7b(.*)\x7d\x7d/g)?(d=!0,console.log("QR Code is valid!")):(d=!1,console.log("QR Code is invalid!"));d?(qrScan.animate._snap(),qrScan.animate._success(),qrScan.data.push(JSON.parse(a)),b=JSON.stringify(qrScan.data),a=CryptoJS.AES.encrypt(b,"propespti2013"),localStorage.setItem("data",a),qrScan.animate._showToast("Dados salvos!",1100),qrScan.updateHTMLArray("data"),qrScan.updateCluster(saved_li_arr)):(qrScan.animate._snap(),qrScan.animate._error(),
null!==a.match(/^\{(.*)\}/g)?qrScan.rejected.push(JSON.parse(a)):qrScan.rejected.push(a),console.log("Dados rejeitados: "+a),b=JSON.stringify(qrScan.rejected),a=CryptoJS.AES.encrypt(b,"propespti2013"),localStorage.setItem("rejected",a),qrScan.animate._showToast("QR Code inv\u00e1lido!",1100),qrScan.updateHTMLArray("rejected"),qrScan.updateCluster(rejected_li_arr))},loadFromLS:function(a){if("data"===a||void 0===a){var b=CryptoJS.AES.decrypt(localStorage.getItem("data"),"propespti2013").toString(CryptoJS.enc.Utf8);
qrScan.data=null===localStorage.getItem("data")?qrScan.data:JSON.parse(b)}if("rejected"===a||void 0===a)a=CryptoJS.AES.decrypt(localStorage.getItem("rejected"),"propespti2013").toString(CryptoJS.enc.Utf8),qrScan.rejected=null===localStorage.getItem("rejected")?qrScan.rejected:JSON.parse(a)},updateHTMLArray:function(a){if("data"===a||void 0===a){saved_li_arr=[];for(var b=qrScan.data.length,c=0;c<b;c++)saved_li_arr.push('<li class="mdl-list__item mdl-list__item--two-line"><div class="sh-status"><div data-cpf="'+
qrScan.data[c][x].cpf+'" class="sh-status-inner"></div></div><span class="mdl-list__item-primary-content"><span>'+qrScan.data[c][x].nome+'</span><span class="mdl-list__item-sub-title">CPF: '+qrScan.data[c][x].cpf+"</span></li>")}if("rejected"===a||void 0===a)for(rejected_li_arr=[],a=qrScan.rejected.length,b=0;b<a;b++)rejected_li_arr.push('<li class="mdl-list__item mdl-list__item--two-line"><span class="mdl-list__item-primary-content"><span>'+JSON.stringify(qrScan.rejected[b])+"</span></span></li>")},
clearRejected:function(){localStorage.removeItem("rejected");qrScan.rejected=[];rejected_li_arr=[];qrScan.updateHTMLArray("rejected");qrScan.updateCluster(rejected_li_arr);qrScan.animate._showToast("Lista de rejeitados apagada!",1100)},initScanner:function(a){scanner=new Instascan.Scanner(a)},animate:{_snap:function(){document.querySelector("#cameraCanvas .snap").classList.remove("snap-anim");$("#cameraCanvas .snap").addClass("snap-anim").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",
function(a){document.querySelector("#cameraCanvas .snap").classList.remove("snap-anim")})},_showToast:function(a,b){var c=document.querySelector(".mdl-js-snackbar");void 0==b&&(b=300);void 0!==toastTimeout&&clearTimeout(toastTimeout);document.querySelector(".mdl-js-snackbar").classList.remove("mdl-snackbar--active");toastTimeout=setTimeout(function(){c.MaterialSnackbar.showSnackbar({message:a})},b)},_success:function(){document.querySelector(".error").classList.remove("snap-status-in","snap-status-out");
void 0!==snapTimeout&&clearTimeout(snapTimeout);document.querySelector(".success").classList.remove("snap-status-in","snap-status-out");document.querySelector(".success").classList.add("snap-status-in");snapTimeout=setTimeout(function(){$(".success").removeClass("snap-status-in").addClass("snap-status-out").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){document.querySelector(".success").classList.remove("snap-status-out")})},3E3)},_error:function(){document.querySelector(".success").classList.remove("snap-status-in",
"snap-status-out");void 0!==snapTimeout&&clearTimeout(snapTimeout);document.querySelector(".error").classList.remove("snap-status-in","snap-status-out");document.querySelector(".error").classList.add("snap-status-in");snapTimeout=setTimeout(function(){$(".error").removeClass("snap-status-in").addClass("snap-status-out").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){document.querySelector(".error").classList.remove("snap-status-out")})},3E3)},_loading:function(a){a?
qrScan.LOADING.classList.remove("transparent"):qrScan.LOADING.classList.add("transparent")},_syncing:function(a){a?document.getElementById("manualSync").classList.add("syncing"):document.getElementById("manualSync").classList.remove("syncing")},_changeSyncStatus:function(){var a=qrScan.data.length;setTimeout(function(){for(var b=0;b<a;b++)1===qrScan.data[b][x].synced?$('[data-cpf="'+qrScan.data[b][x].cpf+'"]').removeClass("error").addClass("synced"):2===qrScan.data[b][x].synced?$('[data-cpf="'+qrScan.data[b][x].cpf+
'"]').removeClass("synced").addClass("error"):$('[data-cpf="'+qrScan.data[b][x].cpf+'"]').removeClass("synced error")},300)},_pageLoaded:function(){document.getElementById("pageLoader").style.display="none"},_changeTab:function(a){3===a&&(actualScrollId="scrollAreaRejected",actualContentId="contentAreaRejected",actualLiArr=rejected_li_arr,qrScan.newClusterize());$("a.mdl-layout__tab").removeClass("is-active");$('a[href="#scroll-tab-'+a+'"]').addClass("is-active");$(".mdl-layout__tab-panel").removeClass("is-active");
document.querySelector("#scroll-tab-"+a).classList.add("is-active")}},checkTab:function(a){a.href.match("#scroll-tab-1")?actualLiArr=actualContentId=actualScrollId=void 0:a.href.match("#scroll-tab-2")?(actualScrollId="scrollAreaSaved",actualContentId="contentAreaSaved",actualLiArr=saved_li_arr,qrScan.newClusterize()):a.href.match("#scroll-tab-3")&&(actualScrollId="scrollAreaRejected",actualContentId="contentAreaRejected",actualLiArr=rejected_li_arr,qrScan.newClusterize())},newClusterize:function(){clusterize=
new Clusterize({rows:actualLiArr,tag:"ul",scrollId:actualScrollId,contentId:actualContentId,no_data_text:"Nenhum bolsista"})},updateCluster:function(a){clusterize.update(a)},clearHTML:function(a){document.getElementById(a).innerHTML=""},sendResponse:function(a){$.ajax({type:"POST",url:"classes/access_presence_list.php",data:{dados:JSON.stringify(a)},cache:!1,success:function(a){qrScan.onSendSuccess(a)},error:function(a,c,d){}})},onSendSuccess:function(a){qrScan.animate._changeSyncStatus();qrScan.animate._syncing(!1);
qrScan.animate._showToast("Sincronizado.")},sync:function(){qrScan.animate._syncing(!0);qrScan.animate._showToast("Sincronizando...");$.ajax({url:"./classes/retrieve_scholarship_holders.php",success:function(a){var b,c,d,e,f=qrScan.data.length,k=a.length,g=0;for(;g<f;g++){if(1===qrScan.data[g][x].synced)c=!1,e=g;else if(2===qrScan.data[g][x].synced)c=!0;else if(0===qrScan.data[g][x].synced||void 0===qrScan.data[g][x].synced)c=!1;var h=0;b:for(;h<k;h++)if(qrScan.data[g][x].cpf===a[h].cpf)if(qrScan.data[g][x].nome===
a[h].nome){b=!0;c=!1;e=g;d=h;break b}else e=g;else b=!1,c=!0,e=g;!0===b?void 0!==c&&(qrScan.data[e][x].synced=1,qrScan.data[e][x].id_bolsista=a[d].id,syncArr.push(a[d].id),syncArr=[].concat($jscomp.arrayFromIterable(new Set(syncArr))),syncArr.sort(qrScan.sortNumber),b=JSON.stringify(qrScan.data),enc=CryptoJS.AES.encrypt(b,"propespti2013")):void 0!==c&&(qrScan.data[e][x].synced=2);b=c=void 0}qrScan.sendResponse(qrScan.data)},error:function(){qrScan.animate._syncing(!1);qrScan.animate._showToast("Erro ao sincronizar.")}})}},
clusterize=new Clusterize({rows:saved_li_arr,tag:"ul",scrollId:"scrollAreaSaved",contentId:"contentAreaSaved",no_data_text:"Nenhum bolsista",callbacks:{clusterChanged:function(){}}});null!==localStorage.getItem("data")&&(qrScan.loadFromLS("data"),qrScan.updateHTMLArray("data"));null!==localStorage.getItem("rejected")&&(qrScan.loadFromLS("rejected"),qrScan.updateHTMLArray("rejected"));var options={},options=qrScan.initVideoObjectOptions("webcameraPreview"),cameraId=0;qrScan.initScanner(options);
qrScan.initAvaliableCameras(function(){cameraId=1});qrScan.initCamera(cameraId);qrScan.scanStart(function(a){qrScan.saveScannedData(a)});scanner.addListener("active",function(){qrScan.animate._loading(!1)});scanner.addListener("inactive",function(){qrScan.animate._loading(!0)});
(function(){for(var a=document.querySelectorAll(".mdl-navigation__link"),b=document.querySelectorAll(".mdl-layout"),c=0;c<a.length;c++)a[c].addEventListener("click",function(){for(var a=0;a<b.length;a++)b[a].MaterialLayout.toggleDrawer()}),a[1].addEventListener("click",function(){qrScan.clearRejected();setTimeout(function(){qrScan.animate._changeTab(3)},500)});document.getElementById("manualSync").addEventListener("click",function(){qrScan.sync()});$(".mdl-layout__tab").on("mousedown",function(){qrScan.checkTab(this)}).on("touchstart",
function(){qrScan.checkTab(this)}).on("click",function(){this.href.match("#scroll-tab-1")&&!isCameraTabActive?(isCameraTabActive=!0,qrScan.clearHTML("contentAreaSaved"),qrScan.clearHTML("contentAreaRejected"),scanner.start(cameraGlobal)):!this.href.match("#scroll-tab-1")&&isCameraTabActive&&(isCameraTabActive=!1,setTimeout(function(){scanner.stop()},500));this.href.match("#scroll-tab-2")?(qrScan.clearHTML("contentAreaRejected"),qrScan.animate._changeSyncStatus()):this.href.match("#scroll-tab-3")&&
qrScan.clearHTML("contentAreaSaved")})})();
