var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[e]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var e=0;return $jscomp.iteratorPrototype(function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var e=a[Symbol.iterator];return e?e.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var e,c=[];!(e=a.next()).done;)c.push(e.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.owns=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)};$jscomp.polyfill=function(a,e,c,d){if(e){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var h=a[d];h in c||(c[h]={});c=c[h]}a=a[a.length-1];d=c[a];e=e(d);e!=d&&null!=e&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("WeakMap",function(a){function e(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function c(a){var f=Object[a];f&&(Object[a]=function(b){e(b);return f(b)})}if(function(){if(!a||!Object.seal)return!1;try{var c=Object.seal({}),f=Object.seal({}),b=new a([[c,2],[f,3]]);if(2!=b.get(c)||3!=b.get(f))return!1;b["delete"](c);b.set(f,4);return!b.has(c)&&4==b.get(f)}catch(n){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");
c("seal");var h=0,g=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var f;!(f=a.next()).done;)f=f.value,this.set(f[0],f[1])}};g.prototype.set=function(a,f){e(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=f;return this};g.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};g.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};g.prototype["delete"]=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return g},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var f=Object.seal({x:4}),b=new a($jscomp.makeIterator([[f,"s"]]));if("s"!=b.get(f)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var c=b.entries(),d=c.next();if(d.done||d.value[0]!=f||"s"!=d.value[1])return!1;d=c.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!c.next().done?!1:!0}catch(p){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var e=new WeakMap,c=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};c.prototype["delete"]=
function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};c.prototype.has=function(a){return!!d(this,a).entry};c.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};c.prototype.entries=function(){return h(this,function(a){return[a.key,
a.value]})};c.prototype.keys=function(){return h(this,function(a){return a.key})};c.prototype.values=function(){return h(this,function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var d=function(a,b){var c;c=b&&typeof b;"object"==c||"function"==c?e.has(b)?c=e.get(b):(c=""+ ++m,e.set(b,c)):c="p_"+b;var d=a.data_[c];if(d&&$jscomp.owns(a.data_,c))for(var f=0;f<
d.length;f++){var l=d[f];if(b!==b&&l.key!==l.key||b===l.key)return{id:c,list:d,index:f,entry:l}}return{id:c,list:d,index:-1,entry:void 0}},h=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=a.next=a.head=a},m=0;return c},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(a){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new a($jscomp.makeIterator([c]));if(!d.has(c)||1!=d.size||d.add(c)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var e=d.entries(),g=e.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=e.next();return g.done||g.value[0]==c||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:e.next().done}catch(m){return!1}}())return a;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)this.add(c.value)}this.size=this.map_.size};e.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};e.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};e.prototype.clear=function(){this.map_.clear();this.size=0};e.prototype.has=function(a){return this.map_.has(a)};e.prototype.entries=
function(){return this.map_.entries()};e.prototype.values=function(){return this.map_.values()};e.prototype[Symbol.iterator]=e.prototype.values;e.prototype.forEach=function(a,d){var c=this;this.map_.forEach(function(e){return a.call(d,e,e,c)})};return e},"es6-impl","es3");scanner={};
(function(){var a,e,c,d,h=!0,g=[],m=[],f=[],b={data:[],rejected:[],LOADING:document.querySelector(".loading"),sortNumber:function(a,b){return a-b},initHtmlElement:function(a){return document.getElementById(a)},initVideoObjectOptions:function(a){scanner={};return{video:b.initHtmlElement(a),continuous:!0,mirror:!1,captureImage:!1,backgroundScan:!1,refractoryPeriod:4E3,scanPeriod:5}},initAvaliableCameras:function(a){Instascan.Camera.getCameras().then(function(b){a()})},initCamera:function(a){scanner.stop();
Instascan.Camera.getCameras().then(function(a){if(0<a.length){var b=a[0];$.each(a,function(a,c){if(-1!==c.name.indexOf("back"))return b=c,!1});scanner.start(b);c=b}else alert("Nenhuma camera encontrada.")})},scanStart:function(a){scanner.addListener("scan",function(b){a(b)})},saveScannedData:function(a){var c;console.log("QR Code content: "+a);console.log("Analysing...");console.log("Executing pretest...");null===a.match(/(\n|\s|\{|\()/g)&&(console.log("QR Code is maybe valid. Checking encoding..."),
a=CryptoJS.AES.decrypt(a,"propespti2013"),a=full_dec=a.toString(CryptoJS.enc.Utf8),(c=null!==a.match(/^\{(.*)\}/g)?!0:!1)?(console.log("QR Code is encoded! Checking authenticity..."),c=null!==a.match(/^\x7b\"\x70\x72\x6f\x70\x65\x73\x70\"\:\x7b(.*)\x7d\x7d/g)?!0:!1):(console.log("QR Code is not encoded!"),console.log("QR Code is invalid!"),c=!1));c?(console.log("QR Code is valid!"),console.log("QR data: "+a),b.animate._snap(),b.animate._success(),b.data.push(JSON.parse(a)),a=JSON.stringify(b.data),
console.log("Dados salvos em RAM: "+a),a=CryptoJS.AES.encrypt(a,"propespti2013"),console.log("Dados codificados: "+a),localStorage.setItem("data",a),b.animate._showToast("Dados salvos!",1100),b.updateHTMLArray("data"),b.updateCluster(g)):(console.log("QR Code is invalid!"),b.animate._snap(),b.animate._error(),null!==a.match(/^\{(.*)\}/g)?b.rejected.push(JSON.parse(a)):b.rejected.push(a),console.log("Dados rejeitados: "+a),a=JSON.stringify(b.rejected),console.log("Dados rejeitados salvos em RAM: "+
a),a=CryptoJS.AES.encrypt(a,"propespti2013"),console.log("Dados rejeitados codificados: "+a),localStorage.setItem("rejected",a),b.animate._showToast("QR Code inv\u00e1lido!",1100),b.updateHTMLArray("rejected"),b.updateCluster(m))},loadFromLS:function(a){if("data"===a||void 0===a){var c=CryptoJS.AES.decrypt(localStorage.getItem("data"),"propespti2013").toString(CryptoJS.enc.Utf8);b.data=null===localStorage.getItem("data")?b.data:JSON.parse(c)}if("rejected"===a||void 0===a)a=CryptoJS.AES.decrypt(localStorage.getItem("rejected"),
"propespti2013").toString(CryptoJS.enc.Utf8),b.rejected=null===localStorage.getItem("rejected")?b.rejected:JSON.parse(a)},updateHTMLArray:function(a){if("data"===a||void 0===a){g=[];for(var c=b.data.length,d=0;d<c;d++)g.push('<li class="collection-item avatar" data-id="'+b.data[d].propesp.id+'"><i class="material-icons circle">cloud_off</i><span class="title">'+b.data[d].propesp.nome+'</span><p class="grey-text">N\u00e3o sincronizado<br></li>')}if("rejected"===a||void 0===a)for(m=[],a=b.rejected.length,
c=0;c<a;c++)m.push('<li class="collection-item"><span class="title">'+JSON.stringify(b.rejected[c])+"</span></li>")},clearRejected:function(){localStorage.removeItem("rejected");b.rejected=[];m=[];b.updateHTMLArray("rejected");b.updateCluster(m);b.animate._showToast("Lista de rejeitados apagada!",1100)},initScanner:function(a){scanner=new Instascan.Scanner(a)},animate:{_snap:function(){document.querySelector("#cameraCanvas .snap").classList.remove("snap-anim");$("#cameraCanvas .snap").addClass("snap-anim").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",
function(a){document.querySelector("#cameraCanvas .snap").classList.remove("snap-anim")})},_showToast:function(a,b){var c=document.querySelector(".mdl-js-snackbar");void 0==b&&(b=300);void 0!==e&&clearTimeout(e);document.querySelector(".mdl-js-snackbar").classList.remove("mdl-snackbar--active");e=setTimeout(function(){c.MaterialSnackbar.showSnackbar({message:a})},b)},_success:function(){document.querySelector(".error").classList.remove("snap-status-in","snap-status-out");void 0!==a&&clearTimeout(a);
document.querySelector(".success").classList.remove("snap-status-in","snap-status-out");document.querySelector(".success").classList.add("snap-status-in");a=setTimeout(function(){$(".success").removeClass("snap-status-in").addClass("snap-status-out").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){document.querySelector(".success").classList.remove("snap-status-out")})},3E3)},_error:function(){document.querySelector(".success").classList.remove("snap-status-in","snap-status-out");
void 0!==a&&clearTimeout(a);document.querySelector(".error").classList.remove("snap-status-in","snap-status-out");document.querySelector(".error").classList.add("snap-status-in");a=setTimeout(function(){$(".error").removeClass("snap-status-in").addClass("snap-status-out").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){document.querySelector(".error").classList.remove("snap-status-out")})},3E3)},_loading:function(a){a?b.LOADING.classList.remove("transparent"):b.LOADING.classList.add("transparent")},
_syncing:function(a){a?document.getElementById("manualSync").classList.add("syncing"):document.getElementById("manualSync").classList.remove("syncing")},_changeSyncStatus:function(){for(var a=b.data.length,c=0;c<a;c++){var d=document.querySelector('[data-id="'+b.data[c].propesp.id+'"] .material-icons'),e=document.querySelector('[data-id="'+b.data[c].propesp.id+'"] p');1===b.data[c].propesp.synced?(d.innerHTML="cloud_done",d.classList.remove("red"),d.classList.add("green"),e.innerHTML="Presen\u00e7a confirmada"):
2===b.data[c].propesp.synced?(d.innerHTML="close",d.classList.remove("green"),d.classList.add("red"),e.innerHTML="Usu\u00e1rio com irregularidades<br>Toque para enviar para a PROPESP"):(d.innerHTML="cloud_off",d.classList.remove("red","green"),e.innerHTML="N\u00e3o sincronizado")}},_pageLoaded:function(){document.getElementById("pageLoader").style.display="none"}},newClusterize:function(){n=new Clusterize({rows:d,tag:"ul",scrollId:actualScrollId,contentId:actualContentId,no_data_text:"Nenhum bolsista"})},
updateCluster:function(a){n.update(a)},clearHTML:function(a){document.getElementById(a).innerHTML=""},sendResponse:function(a){$.ajax({type:"POST",url:"http://localhost/propespReader/assets/classes/access_presence_list.php",crossDomain:!0,data:{dados:JSON.stringify(a)},cache:!1,success:function(a){console.log("Sincronizado com sucesso");b.onSendSuccess(a)},error:function(a,c,d){b.onSendError(a,c,d)}})},onSendSuccess:function(a){console.log(a);b.animate._changeSyncStatus();b.animate._syncing(!1);b.animate._showToast("Sincronizado com sucesso.")},
onSendError:function(a,c,d){b.animate._changeSyncStatus();b.animate._syncing(!1);b.animate._showToast("Erro ao sincronizar.");console.error(a.responseText);console.error("Erro ao sincronizar ("+c+"): "+d)},sync:function(){b.animate._syncing(!0);b.animate._showToast("Sincronizando...");$.ajax({url:"http://localhost/propespReader/assets/classes/retrieve_scholarship_holders.php",success:function(a){var c,d,e,g=b.data.length,h=a.length;console.log("\n\n");console.log(a);var k=0;for(;k<g;k++){console.log("data["+
k+"]: "+b.data[k].propesp.id);1===b.data[k].propesp.synced?(e=k,console.log("J\u00e1 sincronizado: "+b.data[k].propesp.id)):0!==b.data[k].propesp.synced&&void 0!==b.data[k].propesp.synced||console.log("N\u00e3o sincronizado: "+b.data[k].propesp.id);var l=0;b:for(;l<h;l++)if(console.log("    result["+l+"]: "+a[l].id),b.data[k].propesp.id==a[l].id){console.log("    ID de "+b.data[k].propesp.id+" encontrado na posi\u00e7\u00e3o ["+l+"]");c=!0;e=k;d=l;break b}else c=!1,e=k;!0===c?(console.log("qrScan.data["+
e+"][x].synced = 1"),b.data[e].propesp.synced=1,b.data[e].propesp.id=a[d].id,f.push(a[d].id),f=[].concat($jscomp.arrayFromIterable(new Set(f))),f.sort(b.sortNumber),c=JSON.stringify(b.data),console.log("Dados atualizados: "+c),enc=CryptoJS.AES.encrypt(c,"propespti2013"),localStorage.setItem("data",enc),console.log("IDs encontrados: "+f)):(console.log("qrScan.data["+e+"][x].synced = 2"),b.data[e].propesp.synced=2);c=void 0}b.sendResponse(b.data);console.log(f)},error:function(a,c,d){b.onSendError(a,
c,d)}})}},n=new Clusterize({rows:g,tag:"ul",scrollId:"scrollAreaSaved",contentId:"contentAreaSaved",no_data_text:"Nenhum bolsista",callbacks:{clusterChanged:function(){}}});null!==localStorage.getItem("data")&&(b.loadFromLS("data"),b.updateHTMLArray("data"));null!==localStorage.getItem("rejected")&&(b.loadFromLS("rejected"),b.updateHTMLArray("rejected"));var q={},q=b.initVideoObjectOptions("webcameraPreview"),p=0;b.initScanner(q);b.initAvaliableCameras(function(){p=1});b.initCamera(p);b.scanStart(function(a){b.saveScannedData(a)});
scanner.addListener("active",function(){b.animate._loading(!1)});scanner.addListener("inactive",function(){b.animate._loading(!0)});document.getElementById("manualSync").addEventListener("click",function(){b.sync()});$(".dropdown-trigger").dropdown({constrainWidth:!1});$(".tabs").tabs({swipeable:!0,duration:200,onShow:function(){var a=document.querySelector('a[href="#scroll-tab-1"]').classList.contains("active"),e=document.querySelector('a[href="#scroll-tab-2"]').classList.contains("active"),f=document.querySelector('a[href="#scroll-tab-3"]').classList.contains("active"),
n=document.getElementById("contentAreaSaved"),p=document.getElementById("contentAreaRejected");a&&!h?(console.log("Camera activated."),d=actualContentId=actualScrollId=void 0,h=!0,setTimeout(function(){scanner.start(c)},1500)):!a&&h&&(console.log("Camera deactivated."),h=!1,scanner.stop());e?(actualScrollId="scrollAreaSaved",actualContentId="contentAreaSaved",d=g,b.newClusterize(),b.animate._changeSyncStatus(),n.scrollTop=n.scrollHeight):f&&(actualScrollId="scrollAreaRejected",actualContentId="contentAreaRejected",
d=m,b.newClusterize(),p.scrollTop=p.scrollHeight)}});window.qrScan=b})();
